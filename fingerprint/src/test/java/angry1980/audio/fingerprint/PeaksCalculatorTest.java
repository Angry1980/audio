package angry1980.audio.fingerprint;

import angry1980.audio.ClassPathAdapter;
import angry1980.audio.model.*;
import com.google.common.collect.ImmutableMap;
import org.junit.Before;
import org.junit.Test;

import java.util.Arrays;
import java.util.List;
import java.util.Map;
import java.util.Optional;
import java.util.concurrent.atomic.AtomicInteger;
import java.util.stream.Collectors;
import java.util.stream.IntStream;

import static junit.framework.Assert.assertEquals;
import static org.junit.Assert.assertNotNull;
import static org.junit.Assert.assertTrue;

public class PeaksCalculatorTest {

    private static Map<Long, long[]> hashes = ImmutableMap.of(
        //windowSize=1024LLL, overlap = 512
        1L, new long[]{49808680L, 1942173960L, 1942173960L, 2147374162L, -147388734L, 1947578562L, -146388734L, -146390934L, 1947578562L, -146388734L, -146390934L, 1947578562L, -146388734L, -146390934L, 1947578562L, -146388734L, -146390934L, 1947578562L, -146388734L, -146390934L, 1948578562L, -445555230L, -443554228L, -243954628L, -1748990122L, -951393124L, -751987328L, 1051212128L, -748988698L, 1247207098L, -1149591902L, -1847156984L, -1151986890L, 652407508L, -1151789936L, -351789906L, -1751190102L, 1944377412L, -1947390716L, -1644757972L, -1647554608L, 2047612116L, -1951989084L, -642359174L, -1044758974L, -1044960206L, 848006918L, -647154970L, 1247610522L, -1149192474L, -1152192520L, -1151991512L, -1842756208L, -1552589312L, 1447407888L, 1650407302L, -746987706L, -244154602L, 2048211288L, -550590096L, 47210700L, 847206866L, -1447754622L, 1847611280L, 1848412490L, 1448411890L, 52211872L, -243359182L, -352190110L, 2052810496L, -1441960010L, -446355410L, -1847556788L, 447609078L, 1447210102L, -1844558016L, -1749589718L, -1241759574L, -643559594L, -647556030L, 1249808066L, 49608066L, -1246559396L, 1849808110L, 1943974802L, -150589532L, 2049407512L, 1251207272L, -1347593088L, -1242554386L, -551187092L, -1347187694L, -1151188886L, -747387886L, -947390074L, -843358220L, 847212128L, -552788922L, 47408670L, -1247757026L, 1048812322L, 449412302L, -1247156776L, -1950389528L, -444756022L, 1051811320L, 1649011528L, -1044560412L, -244756202L, -247558622L, -949186918L, 2143375384L, -1948993334L, -1946389280L, 1453610472L, 2052808124L, -2042156576L, 1648209722L, -2047757208L, 1048009728L, -1547193104L, -1247756226L, -1752791102L, 1853408280L, 1649207878L, 1451610466L, -1844558832L, -444357206L, -149590310L, -242357630L, -1747387328L, -1751588680L, -844355992L, -2042758174L, 1851609300L, -1947986872L, -1446555186L, -152191490L, -146987502L, -1842156028L, -2043555792L, 1946580194L, -841954996L, -1245359206L, -1150392084L, -1148390930L, -1642158186L, -445355786L, 1945175394L, -1747992478L, -1549388526L, 849612270L, -1352189678L, -846760188L, -846560418L, -1151587922L, -1347787732L, -1151589332L, -1241554984L, -1243956030L, -1444158200L, -642157020L, 252008496L, -548587724L, -752792106L, -1841757000L, -442558818L, -646158778L, -550991920L, 1048407298L, -2147388120L, -242158984L, -1752586888L, -1551590488L, -1547990488L, -146990124L, -1147993124L, -1045560220L, -842160430L, -845757176L, -1550591104L, -1349787704L, -244554824L, 450409486L, 253010294L, -1148793336L, -843957230L, 449409306L, 251609284L, -1246558176L, -549390876L, -1646355974L, 48412068L, -1646754998L, -1646155596L, -1046154770L, 447411668L, 652010096L, -1352790904L, -947191922L, -951192102L, -2045355830L, 1047812884L, 850607504L, 1248609110L, 2049410088L, -1045554788L, -948391480L, -148190328L, -148588910L, -150587300L, -1749190136L, -1750789136L, -2146792724L, -150592920L, 2052608108L, -2146989492L, -844155202L, -147787318L, -947589918L, 1652207910L, 852607270L, 851210482L, -1643557814L, -751192306L, -1350792092L, -1549189876L, 1945576402L, 1451609112L, 1249409110L, -447357028L, -151993080L, -2147189680L, -549192520L, 850810068L, 848411096L, -1043560398L, 651610728L, 447209092L, -1351586934L, -947992884L, -148189882L, -1046759780L, -1552186932L, -1245155390L, 1249808524L, 1247408902L, -244955230L, -442354618L, -750588684L, -748389914L, 1047212472L, -750587474L, -245554208L, -1549188100L, 1252809886L, -243755804L, 1851010692L, 1047210708L, 1450208306L, 847209872L, 1047411870L, -1245955018L, -1445760418L, -1747191130L, -1751791092L, -1642558790L, -2044556212L, -1442559818L, -547792936L, -349592674L, -1844556176L, 1847210472L, 448207688L, -446559608L, -952388074L, 52212682L, 1847206682L, -1749387674L, -2044156412L, -1847154180L, -952590934L, -2047155784L, -1349792932L, 1652408084L, -1551389698L, 249410292L, -1347790312L, -1242759426L, -1841354612L, -241358806L, -1044955606L, -1045559180L, 1247408078L, 1451011518L, -1247760430L, -1552790934L, -1746588488L, -645155782L, -644554990L, -847360606L, -1149793110L, 450608264L, 452812274L, -1643955176L, 451809922L, 1947176986L, -445557570L, -241358970L, 2143378386L, -147788682L, -548188922L, -549789118L, -442754780L, 51008716L, -950587730L, 247612316L, -445757180L, -846560184L, -2046759178L, -647159818L, 50011682L, 250410682L, -548387476L, -550387476L, -547988278L, -1152187890L, -1146586890L, -151991116L, -151791134L, -845555624L, -442154982L, 2052812288L, -2043557006L, -2043557430L, 453010096L, -844156006L, -842355976L, 448009898L, -552389332L, 2146578822L, 1447208112L, -752787280L, -1748790492L, -147390492L, -147192118L, 453208486L, 453006682L, -1749987894L, -245355176L, -844555776L, 850409486L, -551589894L, -1842955028L, -148392912L, 2146374184L, -645957608L, -150990292L, 1448409920L, 1647609324L, -245559218L, -347990726L, -146992704L, 648412308L, -948390884L, -845559422L, -847359590L, 1248610482L, -150789316L, -152391518L, -1750591724L, 2142177372L, -552790096L, -747193100L, -547192878L, -1044560608L, -2045554976L, -1845354176L, -1045554204L, -1044958782L, 2050210482L, 2048008302L, 848209102L, -2047754982L, -247556624L, -844756622L, -1949388134L, -1349387134L, 1647207526L, -1844360228L, -844757004L, 250208698L, -1746593098L, 1648612268L, -647760422L, -644959222L, -1547589936L, 452409918L, -146989902L, 1651409474L, -1643558206L, -1646155606L, -1445354602L, -1242360182L, 1648812314L, -1842155000L, -949791530L, 647608720L, 251812284L, -150987098L, 1650407668L, -747591534L, 449211286L, -244355978L, -946590882L, 849411310L, -247155416L, -150789320L, 1944176172L, -1949389308L, 1050408086L, 1251008088L, -847356206L, -1647754372L, 850209694L, -1644558212L, -1446358198L, -151392896L, -1949388908L, -1844557782L, -952789906L, -348790898L, -2045159818L, -1247357216L, 852411326L, -1442155996L, -2045959790L, -2146791094L, -1243758378L, 253207910L, 50409910L, -146592886L, 1948173984L, -550790912L, -1750790690L, 1947379564L, 2052607488L, 847612474L, -946786900L, -946592498L, -1643355614L, 650212288L, 650012284L, -349988882L, -842156428L, 851408702L, -1348391316L, -1152393078L, -1152389928L, 1648410270L, 1450008284L, 253012676L, 851609476L, 1051607690L, -1444958832L, 1943978598L, -1549388512L, -751387502L, -1749390712L, -1950587712L, -150591922L, -1150792706L, 650607316L, -1752190498L, -1747591706L, -1447758984L, -146788512L, -1445759806L, 249406888L, 1447812694L, -746587294L, -751789090L, -1847756776L, -1042356792L, -1642355408L, 1249007464L, -1547389290L, -1042556968L, 652412326L, 650011524L, -1841959014L, 50808674L, -147991330L, 652212284L, -947188732L, -950790734L, 2050408066L, -2146992500L, 2142979796L, -1447156782L, -1445554232L, -1645558586L, -641554984L, -1646755026L, -151189518L, -446157606L, -244358790L, 652608896L, 648408682L, 1048209072L, -551792916L, -550587708L, -946989694L, -1043157008L, -444959574L, -1749591500L, -444558810L, -2046156612L, 1048410676L, 1050607924L, -1247557018L, -1042557626L, -2146990330L, 1848808722L, 1849409124L, 447808112L, 2048008320L, 249213120L, -445354986L, -646957384L, -750992120L, 1946779964L, -750591134L, 647411466L, -443755014L, -1445955014L, 248407866L, 1851607864L, -646559024L, -751391736L, -749189914L, -1646154994L, 247210698L, -245555614L, -1747788318L, -1549792722L, 1450209908L, 1247411882L, -242558014L, 1947577162L, -1641960230L, 1850810708L, -1147988888L, 2048809124L, -2046156622L, -1347790726L, -751188922L, 649408288L, 652607126L, -1547387722L, -150392284L, -246759992L, -2146392922L, -443156386L, 1053212480L, 1247610108L, 1253410508L, 1653611466L, -845556390L, -1046559228L, -751593118L, 1047806912L, -244956622L, 851011512L, 1252207712L, 1452409484L, -241357606L, -1646557226L, -647756606L, -1444360428L, -1348192888L, -1844958606L, -751187702L, 1248811296L, 448412320L, 1848207920L, -443759230L, 650410072L, 1251811326L, 2051611526L, -244960412L, -444160208L, 1848411464L, -752388696L, 1253412918L, 1049411712L, 1648408106L, 848012908L, -446958788L, 1647413112L, 447613110L, -1348589914L, 1051809320L, 1850010468L, 2050007880L, -749587118L, -844560398L, 1448208114L, 1848611288L, 1651210668L, 1653608702L, -750191130L, -950187710L, -1843358408L, 1947774404L, 1653209910L, -1647160378L, -1151992934L, -644360194L, 450007102L, 250807100L, -1749988716L, -447155998L, -1844357976L, 1649411308L, 1853611304L, 1847411482L, 2053412726L, 2048408708L, -549789292L, -846556428L, -1150187732L, 249811680L, 249207112L, -445758222L, -645757024L, -1447555172L, 1944979420L, -647556632L, 1452211086L, -952590090L, -950990112L, 1948577184L, -2146392078L, 1449807522L, 453407868L, -1046558816L, 848409108L, 51013092L, 1852610116L, 451212512L, -1752789308L, -551791524L, 1451408482L, 1251411266L, 2049412316L, 1848607516L, -951192110L, -950187902L, -550187290L, -1149189678L, 1050807074L, -752792926L, -752591488L, 1852611292L, -246759986L, -1148591890L, -1843557572L, -1843757628L, 653212470L, -346587480L, -847157976L, -1749990878L, 1251009668L, -1350391288L, -1147992290L, -749389502L, -1043359398L, -1042157008L, -1950387712L, 2142178586L, 2143376364L, -1751586898L, -1549192116L, 2146975378L, 2142977978L, 48212278L, -948787722L, 453612894L, 2143174214L, 849011690L, 49012092L, -952787286L, -349392900L, -641560222L, -1047355594L, -1843355192L, -1844556974L, 1848012266L, 1648012492L, -2043559198L, 852608912L, 1649412078L, 451012482L, -1843956422L, -349189096L, -951792472L, 48407666L, 250207902L, -1046157990L, -442156612L, -147192090L, -348788122L, -2041955424L, -1841956398L, -948591302L, -845555824L, -1242560170L, -1446356816L, -1643556568L, -1746591122L, -2046760606L, -950988318L, -1948392906L, 1249609500L, 1849411512L, -1846554214L, -644156570L, -950391678L, -1947788322L, -1349787108L, -1348990300L, -245760216L, 1648211880L, 1852412078L, -1644756620L, -1044356620L, -1348788476L, 2051212700L, 1947979018L, -2146591520L, -551391526L, -947992712L, -1148191328L, -748189674L, 2053011076L, -1547188678L, 1053008696L, -549991132L, 449406910L, 448012290L, -547787732L, -550589132L, 1050009080L, -2044958796L, -1841557020L, -1246956030L, 2143978164L, -1846356402L, -1751187508L, -752187478L, -947991884L, 852611902L, 852412274L, -1951190928L, 2143777572L, -2146792324L, 851411500L, 651210904L, -842759370L, -443756188L, -843559790L, -243355982L, -1843359968L, 1848008088L, -646959808L, 249410476L, 49610502L, 852007890L, 51807690L, 652609320L, -442359576L, 847207520L, -845559822L, 1449410080L, 1049211680L, -1946988276L, 1053411906L, 1650208298L, -1645354976L, -551787678L, -442357574L, -445558170L, -2044158224L, -2042758974L, 252011276L, -1749388076L, -149788690L, -242555796L, -647159224L, 1248410272L, -151787724L, -1847155212L, -1642755424L, 1448411310L, 1942775394L, 847608696L, 1051009280L, -350588278L, 1449611712L, 2050207086L, -643959776L, 2144578812L, -1351988480L, -2043354592L, -1043155016L, -152789932L, -950191928L, -2046959614L, -2043157628L, 2048809924L, -347992714L, -1150593330L, -1149190904L, -1148590928L, 451808316L, 1945374362L, -1244556576L, -752189906L, -748787284L, -2043759600L, -2042758378L, -1751987482L, -1746587920L, -1244354816L, -1844357186L, 848011698L, -447759372L, -951591908L, -1951592072L, -2046555994L, -1751390118L, -1951391532L, 1248209478L, 1250608506L, 1648612094L, -1646359372L, -2047159386L, 2049807502L, -1549588502L, -1641756588L, 1451807890L, -348392136L, -1547788096L, 1649010686L, 852609878L, -951190104L, -951192704L, -1151592324L, -1244556820L, 2145580206L, -1444554624L, -1046957608L, -1246556800L, -1042358196L, 50409084L, -2043560378L, -749388508L, -1245555820L, -1043754380L, 2051611066L, 2052211066L, -1246557400L, -1841760400L, -1351588514L, -347591114L, -347392128L, -242359376L, 249410120L, -1750389706L, -441756790L, -1246360380L, -1351392894L, 2143374200L, 649806866L, 1049208098L, 1252209082L, -1751989878L, -1750388672L, 2052209124L, 451410324L, 451211724L, 1848413118L, 53010076L, 248408076L, 51210096L, -1245756608L, -1951388916L, -1949589516L, -247755232L, -148189530L, -1148391902L, -2047559420L, -2043759824L, 851809878L, -1751189912L, -948388304L, 451611700L, 1447209920L, -1946587302L, 649808078L, 651211082L, 650809680L, -1846159388L, -1847755972L, -1351590080L, 50011280L, -1047758026L, -1147990530L, 1448410088L, 851608498L, -445956596L, -1350590900L, -1552389512L, -146788680L, -1042358778L, -447759178L, 248210118L, -2147386936L, -947793076L, 250410676L, 1252010518L, 1052611528L, -2042156030L, -1441358830L, -1446955008L, -1642959228L, 453210088L, 1853211122L, 1647411100L, -2045158984L, -1042355584L, -1043554414L, -2047557416L, 1047209726L, -1845554408L, 1050812288L, 2053009892L, -247756228L, -1150388706L, -152789332L, 1447208304L, 847409526L, -1247357582L, -1752790934L, 2147376408L, -2147192928L, -2146392104L, 2143379792L, 451008270L, -847357390L, -1845157190L, -1443355008L, -1152792676L, -952792698L, 848809092L, 253409112L, 1944378564L, -1846556974L, 1048208874L, 1048412676L, 2049809476L, -1152791692L, -546389532L, -1646757030L, 1049208664L, 847213112L, 648613098L, -1951387122L, -152591480L, -352788130L, -1746792514L, -1546792520L, -1549188120L, -1844357616L, -843159176L, -1044154974L, 1847407102L, 1051607474L, 447808512L, 250611296L, 1249411472L, -243355024L, 851409686L, -1843357596L, 53406900L, 48012524L, -1347787472L, -1551588898L, -442555176L, -1749388282L, -1244757030L, -1441555214L, 1451410670L, -548588492L, -351590912L, 1048212864L, -446758818L, -447758018L, -1747992312L, 1249407688L, -645757028L, -547188306L, -1843155026L, -1151587730L, -1151589906L, -1349389914L, -1152187716L, 449609082L, 849408108L, 2049807868L, -1550190926L, 1450010322L, -844956974L, -842156426L, 652812680L, 1451010300L, 451210526L, 447810478L, -552191924L, 1648808120L, -1751590334L, 450412086L, -243158210L, -1751590894L, 249411064L, -1241759802L, -246154774L, -2043154774L, -151592902L, -949989692L, -1846759214L, -1843759576L, 851413096L, -946787074L, -446357588L, 1648412066L, 1853210710L, 1650607516L, -748588488L, 2144377814L, 1649413112L, 2142179396L, -148792726L, -148990912L, 1652011288L, -1547588912L, -447758176L, -1551589080L, -1841760392L, -1843355632L, -843755402L, -446954402L, 48007498L, -1847759786L, -2047755820L, -1843155574L, -1150988280L, -646755828L, -842358604L, 1253211316L, -1246556180L, -1244155832L, 50807498L, -152590880L, -347188476L, 2052008724L, -2041757994L, -2041958198L, -647355198L, -1243359782L, -148387876L, -1445355024L, -550191530L, 651411112L, -1644955992L, -1241557590L, -1747190504L, -1149989928L, 851606888L, 1447809278L, -1947989712L, -150391722L, -1547991902L, -842957586L, -1443154428L, -749390908L, -1844358204L, 249412680L, 1948376600L, 1853409288L, -1551589896L, 1945175194L, -751387474L, -642757780L, -548590514L, -548586902L, -1243954800L, -148787698L, -443154812L, -1148391718L, 53009096L, 1453007286L, -1845958206L, -1442757186L, 1252410068L, -1443555398L, -1752591680L, -1746392880L, -1547788286L, 1653610086L, -552793102L, -647559394L, -1247755420L, -242358996L, 1249008886L, 1247411886L, -1750192934L, -2043560428L, 248011308L, -752588492L, -1647758014L, -1752793078L, -644758776L, 1249612320L, -1746592710L, -146792520L, 1849612304L, 1849612468L, -1948793082L, -1946592282L, -441560572L, 1447809494L, -1446556978L, -1243759022L, -949792290L, 1448610112L, -1242156586L, -1246357376L, -2043156174L, 2144777764L, 2053612868L, -346589124L, 1250210508L, 1448010320L, 450208468L, 452209080L, -751988890L, -751188890L, -845756568L, 1247808698L, -1552189484L, -1550589486L, -1847756204L, -246554808L, -1748187508L, -2045555602L, -1043760378L, -843358994L, -2043957780L, 251209716L, -147588692L, -750189298L, -646156032L, 1051809080L, -1747787320L, -1242760182L, -1044354786L, -1043954380L, -2146791324L, -2044555408L, -244556230L, 450610480L, -1643356428L, -1245355424L, 1946178204L, -2146787082L, 652408906L, 1251411298L, 249608320L, 2048210474L, 647807502L, -347390904L, -351593120L, -647758818L, -1948792874L, -949592306L, 2145375410L, -146390930L, 649606864L, -241554168L, -1442154176L, 250606920L, 448607476L, -1346593294L, 250410118L, 250010084L, -1645156778L, -641554624L, 50607270L, 52412496L, -644757980L, -349789682L, 1048810510L, -1351187698L, -152591298L, 650012876L, 850007300L, -1147787690L, 1947976774L, 1852609700L, 850211682L, 2144178972L, 2143778574L, -351390478L, -1751989110L, -1751787710L, 1648012064L, -1350791934L, -151388322L, -243158818L, 1651606906L, -641760170L, -1951191090L, -844758170L, -1447558182L, -1352590890L, -749989682L, -846960022L, -1150592706L, -244954972L, -1245954802L, -1246354802L, -1647754994L, -1551987094L, -246754186L, -1349790890L, 1647211294L, -1747388500L, 1852608276L, 1853010272L, -1441956622L, 1851410706L, -349188512L, -350390720L, 1449412084L, -1548590916L, 853407676L, 1451412928L, 2048810882L, 847410904L, 850407916L, -1150592116L, 1942777408L, 1251608698L, -645555408L, -645558218L, 449208666L, 1649412522L, -1247759186L, -1552787122L, 250612288L, -645558972L, -844554630L, 1947580162L, -947389912L, -950189920L, -845756218L, -147188134L, -1044356020L, 50811888L, -2043155386L, -1847759608L, -245758182L, 1447207514L, 2047212694L, -1950989316L, -1551788702L, 852812486L, 2142379574L, 1848212316L, 1851808322L, 2144378216L, -1150586882L, 851608076L, 52010316L, 49610118L, -1150590074L, 452012298L, -2042555006L, -349189702L, -244358020L, -2047559618L, -352192482L, -444755808L, 1452412888L, 1252413102L, -1846156622L, -151187678L, -947387702L, 649208886L, 1942577982L, -1241359600L, 651408098L, 651809100L, -843158432L, -349588872L, 451411898L, -1043755808L, -1152390912L, -246555628L, -346587280L, -1647754976L, -247754998L, -245960210L, -845957204L, -245556974L, 1449612270L, 453207728L, -350992072L, -1148789310L, -152189276L, -150593076L, 1849413074L, 1847410686L, 2142177960L, -1350388708L, -548391898L, -749992082L, -751789672L, 850410098L, -244955584L, 250412478L, 452012724L, -2042960598L, -349593320L, 1647411280L, 1450408098L, 1451809672L, -1750589134L, -1950592112L, 47608122L, 252612898L, -1352593300L, -1350991712L, -1746989876L, 1651810324L, 653212696L, 2052809478L, 2049409876L, 1051810678L, -149388682L, 2047609118L, 2048806690L, -148792532L, -842157388L, -1442754588L, 1852007710L, 1251809888L, -1152593306L, -447160410L, -946787498L, -1949389698L, -750389884L, 49610122L, -150390902L, -246159186L, -846359382L, -846358168L, 2052009102L, -950590898L, 1247209066L, 1849208486L, 1649210720L, -247756002L, -152190114L, -2045156820L, -647758202L, -747988130L, -547988122L, -1350989916L, -1045955182L, -247755792L, 1250412104L, 1251611514L, -1952787704L, 2052612488L, -1445154208L, 2144575998L, 1253008676L, 1048807278L, -548787702L, 448407110L, 2048408918L, 1450208878L, -1444756190L, -1546787476L, -246754632L, -1947393132L, -1642356802L, -152392500L, -1843156998L, -1551988678L, -951787080L, -1146793114L, -152590874L, 851207318L, 848212484L, -1847154402L, -2146988706L, -1442160180L, -1841960390L, -844754768L, -1748589292L, -1748988880L, -1645159594L, 253211092L, -2146588912L, -1845160174L, 649607668L, -1550990112L, 1447408468L, 1451808268L, -548191718L, 2145579416L, 1047211920L, 1053009284L, 1053409112L, -1245960024L, -2147390712L, -150788712L, -1241558208L, -1246757400L, 1250407918L, -844557378L, 1850012912L, -1443957990L, -1841960618L, -442559396L, 652809088L, -642357998L, 51409478L, 248407090L, 1251012282L, -243557170L, 1049412264L, -847155580L, -1152190126L, -348387124L, 51609088L, 1649810114L, -1746989692L, -1646758620L, -642356822L, 1852612274L, 2052611120L, -1242157804L, -1842756608L, 1048012688L, -1045554604L, -1245555022L, 2048812296L, 1651807516L, -1148191692L, -644557604L, 1250210264L, -1245954796L, 2048210678L, -749591282L, 1849807706L, -1152791936L, -843559206L, -1842759206L, 1947976810L, 653008716L, -245358794L, 449406896L, -1647156000L, -1441557026L, -1349587696L, 249608868L, -1847757778L, -1148391488L, -146591526L, -146592728L, -1746588734L, 650210266L, -1444756408L, -1752188902L, 51412110L, 52812110L, -1547387702L, 1848608526L, 452810284L, 448611068L, -1446154178L, -1948593088L, -245158802L, -747190074L, -243560370L, -1548788480L, -1047755790L, 52807108L, 452611698L, 651411898L, 852411896L, 847209896L, 848808116L, 53411276L, 2053406728L, 2053409484L, 849812310L, -1349587676L, -146388876L, 1052611686L, -642156022L, -1042556218L, 1047206698L, 253610328L, 252208072L, -246759232L, 51612490L, 2048806674L, 1851211298L, -348187922L, -748388722L, -447159398L, 848007922L, 1052208718L, -1246160184L, -548793084L, 52006894L, -1046957200L, -1949191680L, -1446556200L, -1348989080L, -1846558376L, -1844158388L, -347388114L, -844558008L, 1050608674L, -1747987880L, 1848811320L, -946988708L, 850612122L, -1549393134L, -749791896L, -643355200L, -644155214L, 1850811298L, 650213078L, 1450408278L, 1452607076L, -152591328L, -151193292L, -151188112L, -350987120L, 1248812282L, -2147391300L, -2044555414L, -1041759372L, -1748988312L, -552192128L, -1149589286L, -1644559632L, 2049807892L, -244557794L, -1351788904L, 1943374774L, 448808116L, -747388908L, 2145576578L, -546390902L, -1045556198L, 48411098L, 47212276L, -546990884L, -1350990894L, -552389280L, -1043559422L, -1246756168L, -1246557568L, -1044560408L, -845760368L, -1151791312L, -2045555986L, 453609470L, 1942177408L, -1750988726L, 449011488L, 49412682L, -947189898L, -2042960616L, 849006700L, 649008098L, -147790902L, 2144376974L, 247409492L, -752789922L, -1552788708L, -2045755412L, -2044755412L, -1244557220L, -1242954996L, -445359810L, 2048412088L, 51209488L, -1348790896L, -1752190920L, 2049810678L, -647756816L, 2145380420L, -948389884L, -549991072L, 649012316L, 2051407116L, 250006866L, 2051610678L, -547188728L, -549388712L, -1549387674L, 650613114L, 649207722L, -1950793282L, -242954430L, -150989884L, 1449410116L, 452008106L, 1853209304L, 1053612474L, 850609080L, -2147387120L, -1947391512L, -1948992286L, 1249608114L, -1150590926L, -1552190720L, 1447210480L, 2142174962L, -1843159388L, -1348791084L, -1843959222L, 648609900L, 48606912L, 48812312L, -552788878L, -347989124L, 1649012112L, 648811094L, -1444557224L, 2145379584L, 1450411278L, -245557218L, -244956022L, -244758414L, -1245959020L, -1042956594L, 848607914L, 1253008280L, -152790722L, 2047208884L, -1042155974L, -847160186L, -846560216L, 450412678L, -2043554408L, -1446155202L, 48212668L, -1044758218L, -1244760016L, -2041558408L, -351592474L, -1148991508L, -1349991690L, 847408466L, 650612264L, -1044556432L, -641554230L, -645154372L, -845156230L, -1548993132L, 453206864L, 1453008522L, -347189918L, -1244356192L, -1244559176L, -350587678L, -947792094L, -1845959408L, -1841755406L, 53011696L, -2041956796L, -1843556814L, -242756784L, -1042556024L, -1244155998L, 1050610098L, 851410696L, -1843754590L, -1949787674L, -1948587130L, 1849410698L, -1947789100L, 1650411894L, -151388312L, -151189934L, 52211726L, -147388934L, -351592534L, -2146392712L, 1945976986L, 1943978170L, -752588134L, 1048412896L, 248412308L, 1650008876L, -1948391922L, -1348388916L, -1149587334L, -1746989934L, -548387728L, -1148789086L, -645959392L, 1449409104L, 2144376362L, -1043558630L, -246356030L, -644157174L, -1642360212L, 1942376612L, 250610090L, 448410098L, 848409078L, -350590922L, -1149792882L, -1445954786L, 1449610114L, -645957218L, 1851610110L, -1043357194L, -1245558208L, 650209088L, 2050210288L, 51612296L, -243757608L, -946590720L, -441755830L, -842155602L, 450012074L, -1750992300L, -1047555030L, -1046157410L, -1244958430L, -1047755998L, 1848208102L, -247555010L, -552590532L, -2041558172L, 1049808496L, 649610072L, -751793128L, -947591912L, -1041956978L, 1452008080L, 2142174798L, 1946176378L, 849612292L, 2049611320L, -2042954632L, -549188476L, -1948591726L, -752789124L, -1845154186L, -2045554186L, 2047810510L, -1646959190L, -351187128L, 1247810072L, -1244556976L, -1546987294L, -241958780L, -447155190L, -1950188496L, -1747392134L, -246354220L, -1551588674L, -642359592L, -1352387310L, -1147987508L, -1347189890L, -949587708L, -752788702L, -647754198L, -646558394L, 248211302L, 250411322L, -1841755828L, 2143377162L, 250610500L, 1849610518L, -1949590920L, 51409100L, -1642159198L, -947193112L, -2044160186L, 851809104L, -1443358996L, 1448211308L, -244556416L, -748389886L, 651811078L, 1453609678L, -1047154816L, 851008080L, 852010070L, -1551190130L, -1445957984L, -548589088L, -551188280L, -841555576L, 1649410116L, -351390922L, 648213068L, 650808886L, -241958178L, -549988528L, -551791110L, -1045958630L, -1245955376L, -948787732L, -746387732L, -2046159632L, 2049207688L, -1352788710L, -1751589720L, 1249806912L, 250209710L, -646356406L, -348192696L, 649412308L, -1045560202L, -245559430L, -641558030L, -752391484L, 649409720L, -1243159022L, -1151589476L, 1052007880L, 652208480L, -151590104L, -148789506L, 1652406920L, 853010266L, -245959572L, -1241759982L, -748193302L, 1852209298L, -1947391880L, -1947991912L, -241559218L, 648412696L, -1149987918L, -1351187718L, -1442358202L, -1442954174L, -149389124L, 850810866L, 1651212502L, 1447410314L, -1146787128L, -552389926L, 2047610674L, -843956404L, -351788880L, 2143177616L, -549587124L, -546992134L, -644954818L, -1549987280L, -1552392926L, 2142377208L, -1951187488L, 48606884L, 853411882L, -644960190L, 651413072L, -952791928L, 251209074L, -643758212L, -148789304L, 2142378188L, -1949592324L, 248809692L, 248406900L, -1046558570L, -1047758622L, 647208920L, 649211482L, -1549987734L, 1250206924L, -1550793118L, -1750788076L, -1746990290L, -2042556008L, -1750187084L, 648810318L, 1648810522L, -1844556172L, -1841960422L, -1346389114L, 1945978384L, -547190112L, 1051409484L, -1346792304L, -1146591502L, 2050211298L, 452211266L, -1351987124L, -1445160182L, -1445557818L, 1049408092L, -246760176L, -548587078L, -1443958002L, -844155772L, 853609876L, -1647157230L, -1845557574L, -644359982L, -447159376L, -1443357376L, 1251408676L, 1944178208L, 248010492L, 453009692L, 2049210104L, -846155430L, -750392704L, -443154574L, 1946779618L, -246158830L, -2047557018L, -1444556980L, -1949389482L, 1450808488L, -549591698L, -551391698L, -1751787684L, -551591130L, -1243560626L, -1948793280L, -1346391924L, -746992326L, -346792078L, -350587930L, -1350788736L, -1952588718L, -1747791500L, -1147787132L, -1042757604L, -1152588706L, 1447212920L, 1447812698L, 2145976398L, 1847609100L, -641354426L, -1749589518L, -846756200L, -641354208L, -645556784L, -1041956596L, 648607906L, 1251807874L, 649012086L, -149393106L, 49413124L, -1751792522L, 450008876L, -2044955622L, -1152593078L, -951591478L, 249609098L, 848610902L, -951590504L, -952790722L, -2042357984L, -549988690L, -1951790880L, -1947190884L, -1641554630L, 2050212280L, 453208280L, -247158386L, -1752390686L, -1951789500L, -346587674L, -841754770L, -952591474L, -1752792524L, 1649412920L, -2045759176L, -1245755986L, 51406710L, -947988502L, 52609096L, 2047412096L, 2051012908L, 453209120L, 453411720L, 1253211726L, -347989910L, -1746788702L, -946588482L, -1241759390L, -1549991302L, 1253408300L, 1048406716L, 1051812082L, 2146379572L, 2146376978L, -243156228L, 2146778612L, -1947588524L, -1946590304L, 1253608498L, -1445156212L, -152791916L, -152790880L, -151387904L, -1348787298L, 48011074L, -847158612L, -243758578L, -247159618L, 1648209282L, -1947193108L, 849412328L, -1445554392L, -1844356792L, -1643756426L, -1643158984L, 248612910L, 452610086L, 1852413088L, 1852407474L, 1848412880L, -1041557186L, -441557206L, 250208672L, -1150592326L, -1146792302L, -646157198L, 48411900L, -1246558808L, -147788130L, 2143778222L, 249807484L, -443959624L, -1445159624L, -2147391078L, 2145776184L, 851411474L, 851410476L, 1850807892L, 650809466L, -1246957400L, -1747587702L, -1047560574L, -1447756174L, 847208510L, -1246559818L, 1850412476L, -1547787680L, -347389136L, 1049406878L, 852011672L, 1052609094L, 1251609694L, -1548390504L, -2041755810L, 1848010106L, -1350592896L, -1647756168L, 247208524L, 1048211286L, 1050607466L, -1146987690L, -1146591932L, -1347588320L, -246356394L, -351589482L, -551791534L, -243955370L, 648212078L, 850609126L, -1147590872L, 1942375182L, -951389316L, -2046556376L, -2046760430L, -750989922L, 1248811092L, 48809902L, 249610910L, -1750389132L, 1647411074L, 2145373974L, 2144374004L, -641757188L, 452613074L, -1043154222L, 252411064L, -644356018L, 1852607704L, 52610916L, -951989100L, 447209694L, -1352590482L, -1352787480L, 2143578796L, 2051011898L, 52609122L, -148992718L, 1849610282L, -1647156792L, 2050808726L, 1852212694L, -1349188294L, 2145575806L, 847212326L, 847410700L, 1852208102L, -1951592116L, -1949388716L, 847609110L, -847358178L, -951790920L, -748387932L, -1352591680L, 847210922L, 47611274L, 451012874L, 448606668L, 2048011328L, 1651206920L, 2048010064L, 449007508L, -242154576L, 449411472L, -546591912L, -349991920L, -644959216L, 1947977588L, 2143975988L, -748988106L, -948388090L, -347992712L, -148187712L, -147793274L, -1948987688L, -152587732L, -752786892L, -2047759830L, -846759816L, 2050812322L, -949190294L, 1052807080L, 1848407324L, -1241358202L, -152589088L, 1247610090L, 1050010064L, -1948791904L, -1441956000L, -1946988878L, 48812916L, -641560404L, -749589516L, -149589722L, -1046956830L, -842759032L, -2042758376L, 249810270L, -350186888L, -2045554178L, -1645954200L, -1045754214L, -1842558628L, -346990326L, -546990298L, -1644559604L, -1350588502L, -1748391304L, 1649207290L, -847755206L, -1645955392L, -1951589680L, -351590492L, 850412688L, -444959608L, -444558198L, -1346788886L, 1946577774L, 2143977370L, 2143977396L, -1350389500L, -1841758832L, -750791322L, 249812464L, -2041956830L, 1248610302L, -642557818L, -352388324L, 451608926L, -843359378L, -351789298L, -951791088L, -1352591092L, -1351789932L, -1846757226L, -2146989932L, 1944775972L, 1649809878L, -350187330L, 1853210120L, 850809916L, 850811276L, 1053011084L, -1946590096L, -1241559588L, 1849006888L, -1641557990L, -1446355968L, 1247811126L, -949391886L, -1149389290L, 252007518L, 2147176014L, -2046559022L, -1047156178L, 447408902L, 247208904L, -242555592L, -748586872L, -647554412L, -846954430L, -1348587282L, -148388698L, 1850407884L, 2047210102L, -1045558968L, 1850808106L, 2146175574L, 2144775000L, -642356606L, -2045758792L, -845754396L, -447554212L, -1643959018L, -1446955988L, 452212866L, 1053607088L, -842160584L, -246356182L, -2045358420L, -747993296L, -644559808L, -645759800L, 2048412072L, 1850408864L, -2146587536L, -447354784L, -447155778L, -246755970L, -842355768L, -644956028L, 1049011296L, 849209096L, -750989336L, -1948788676L, 1852609068L, -949791134L, -1150788116L, -441960418L, 1853209922L, -1748992678L, -949592692L, -946791920L, 453206910L, -1351992880L, -1552188488L, 1652809274L, 2052608296L, -1946593280L, 2144775372L, -1946592736L, 1047209082L, 1049809114L, 1649012926L, 1647810912L, 2047612712L, 2047812670L, 1250011084L, 1449007664L, -2043160012L, 248407528L, -1749589536L, 849208668L, 449212310L, -149188504L, -547388304L, -1747192710L, 449607668L, 1051806924L, -348389292L, -1951790310L, -243158622L, -1442955790L, -1446154422L, 1648807474L, 1451207488L, 1053609876L, 1847412478L, 2050208288L, 1449209126L, -645356610L, -645558376L, 1053406894L, 1051406704L, -1445159370L, -1952590508L, -948787126L, -750988880L, -1844956428L, -952390728L, 249211680L, 450412298L, -346590874L, -347990276L, 1852006924L, 1852012520L, -1644355620L, -1644755432L, 849007888L, -1751190112L, -352189892L, -1647357230L, 1648608066L, 848010708L, -1843758190L, -1642558816L, -947392108L, 253209266L, -1641557986L, 647611720L, -1846159228L, -1846754778L, 1047807900L, -247757196L, -1046957224L, 453612504L, 1850208706L, -647159390L, -1149790294L, 647809264L, -346791512L, -2146591310L, -442555012L, 1847210098L, -1843557828L, 2052408088L, -148791902L, -351588276L, 1447211684L, -647557830L, -644954782L, -1150989088L, 2144778172L, -1845155626L, -1950788090L, -1747588328L, 1942777372L, 1452411074L, 2051809114L, 651811068L, -2045556378L, 1249411304L, 1051011294L, 51411696L, 1648011080L, -151991322L, -1350791088L, -1349791088L, 1848612086L, -548187736L, -1347988520L, -350188516L, -350390134L, 248408094L, 1253207876L, 1253210086L, -150190112L, -151992918L, 650410106L, -151388102L, 1047611684L, 1249209094L, 1947976372L, -1352791320L, -447160426L, -441754406L, -351788502L, 1848408082L, -749589736L, -844757022L, -844360384L, -1349193278L, 453410106L, -547989894L, 448009870L, 248211892L, -847157212L, 1852012484L, 2145375808L, -245359232L, -1441959200L, -746992896L, -643554194L, -242555984L, -246159186L, 451210506L, 1851212510L, -1041757586L, -646554786L, 1648412724L, -1749988074L, -1746590090L, -1644757222L, 248610874L, -243759406L, 1451008688L, -1147989112L, 847612900L, -151991098L, -1550191126L, 1451612902L, -1948391704L, -349591700L, -1242760568L, -1042759012L, -1348190490L, -349790532L, 1851606882L, -1551192710L, -951191080L, 848809510L, -446159996L, 51408102L, -1443155802L, -149389890L, 649409110L, -1246560586L, -2046359188L, 1851411088L, -1443359610L, -1751392332L, -146589702L, -146591280L, -146588886L, -1746590130L, -243356380L, 1048411514L, 1648809094L, -1444558170L, -1446158824L, -751189280L, 449010476L, 449011278L, -1548590912L, 849611496L, -1149388722L, -1150187282L, -446357172L, -444357818L, -1749586924L, 1450407724L, -2044559630L, 2143975412L, -946789910L, -747989702L, -2043558174L, 2051412508L, -444355824L, 1648013122L, 1447609874L, -748587504L, -1348389490L, -148390292L, 1648609720L, -751793112L, -247356820L, -1441560212L, -1841556770L, -1346589526L, -1644960016L, 249807294L, -1149787880L, 1048812088L, -1949188912L, -245558370L, -1844555014L, 1052611502L, -244155772L, 647408320L, -1445559608L, -1151989722L, 1648012274L, -1443157420L, -1948391912L, 1942580416L, -243555176L, -1643358172L, -1647354588L, -1347788286L, -946787886L, 50409076L, 1450409078L, 1943376992L, 1247209298L, 1847411488L, -1646759620L, -1844758618L, 1649407492L, -947592528L, -1641359628L, -1644555022L, 1945173976L, -148387086L, -242954972L, -1751987702L, -1747388726L, -445155030L, -444554392L, 2050808290L, -146591316L, 452612280L, -1947392122L, -1046559608L, 1247609088L, 2051809488L, -950587702L, -750589504L, 2143376366L, -1949187326L, -1847359008L, -1845159414L, 49412098L, -1243355804L, -1447757978L, -847160026L, 1852608670L, -1443154978L, -1146592280L, -950389480L, 47609120L, 53609100L, 47612266L, -1646754404L, -551791732L, -1446156168L, -949786886L, 650011514L, -245557594L, 2051810314L, 652013120L, -643154970L, -645358172L, 852409078L, -146590712L, -746587080L, -949387080L, -1750791926L, -1749587508L, -1043959806L, -150188726L, -643956632L, -845754972L, -1246556186L, -841759188L, -1047759216L, 249011880L, 451209698L, -2044757796L, -1148590698L, -1646955576L, 1449407300L, -1045554588L, -1844156210L, -2045155208L, -2042954806L, -146791884L, 51209276L, 47807864L, -148191708L, 2052607298L, -1347393126L, -1347388730L, -1247560576L, -552792680L, -646956198L, -1348191880L, -1348789300L, -552791902L, -352786872L, -347990884L, -647758208L, -950392692L, -1843955198L, -1843356830L, 1049611866L, -547788124L, 652212316L, 2142975384L, 1653606888L, -1843960176L, 851609070L, -1149991276L, -1347789322L, -245557976L, -951590880L, -1949390934L, -1951592090L, 2047809526L, 2051408086L, -645559400L, 1649607094L, 2050807074L, -947587690L, 850612094L, 252609680L, 452408668L, -1643356200L, -1242560010L, -749591294L, 50408308L, 650411488L, 650412688L, -1147188076L, -241955628L, 1850212268L, -1644560414L, -1845359194L, -1548191900L, 2143974400L, 2143978776L, -1147791934L, -1647558998L, 50812492L, -546590902L, -148392130L, -948188724L, -1747188312L, -1243358376L, 2049008904L, 1852811890L, -147188734L, -146388734L, -146390934L, 1947578562L, -146388734L, -146390934L, 1947578562L, -146388734L, -146390934L, 1947578562L, -146388734L, -146390934L, 1947578562L, -146388734L, -146390934L, 1947578562L, -146388734L, -146390934L, 1947578562L, -146388734L, -146390934L, 1947578562L, -146388734L, -146390934L, 1947578562L, -146388734L, -146390934L, 1947578562L, -146388734L, -146390934L, 1947578562L, -146388734L, -146390934L, 1947578562L, -146388734L, -146390934L, 1947578562L, -146388734L, -146390934L, 1947578562L, -146388734L, -146390934L, 1947578562L, -146388734L, -146390934L, 1947578562L, -146388734L, -146390934L}
    );

    private Track track1;
    private PeaksCalculator calculator;

    @Before
    public void init(){
        calculator = new PeaksCalculator(new ClassPathAdapter());
        track1 = ImmutableTrack.builder().id(1).cluster(0).path("/test1.mp3").build();
    }

    @Test
    public void testTrack1(){
        List<TrackHash> hashes = getHashes(track1.getId());
        Optional<Fingerprint> f = calculator.calculate(track1);
        assertTrue(f.isPresent());
        List<TrackHash> result = f.get().getHashes();
        assertNotNull(result);
        assertTrue(result.size() == hashes.size());
        System.out.println(Arrays.toString(result.stream().mapToLong(TrackHash::getHash).toArray()));
        IntStream.range(0, result.size()).forEach(i -> assertEquals(result.get(i), hashes.get(i)));
    }

    private List<TrackHash> getHashes(long trackId){
        AtomicInteger time = new AtomicInteger();
        return Arrays.stream(hashes.get(trackId))
                .mapToObj(hash -> ImmutableTrackHash.builder().trackId(trackId).time(time.getAndIncrement()).hash(hash).build())
                .collect(Collectors.toList());
    }
}
